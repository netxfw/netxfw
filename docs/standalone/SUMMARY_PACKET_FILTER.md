# netxfw BPF 过滤流程简明总结

## 数据包处理顺序

1. **协议识别** → 2. **基础检查** → 3. **白名单** → 4. **动态黑名单** → 5. **静态黑名单** → 6. **速率限制** → 7. **连接跟踪** → 8. **IP+端口规则** → 9. **ICMP过滤** → 10. **返回流量** → 11. **默认策略**

## 关键特性

- **动态黑名单**: LRU哈希表，支持自动封禁和过期
- **静态黑名单**: LPM Trie，支持CIDR网段匹配
- **采样配置更新**: 每1000个包更新一次配置
- **连接跟踪**: 支持返回流量自动放行
- **LPM Trie**: 高效的IP范围匹配
- **模块化设计**: 功能独立，易于扩展

## 配置驱动

所有行为由 `global_config` 映射表中的参数控制，支持热更新。